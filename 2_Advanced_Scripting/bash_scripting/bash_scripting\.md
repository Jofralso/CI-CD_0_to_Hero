# Advanced Scripting Skills - Bash

## Overview

Bash scripting is essential for automating repetitive tasks and managing system operations efficiently. Bash, a Unix shell and command language, is widely used for writing scripts to automate processes, manipulate files, and execute programs.

## Detailed Explanation

### Basic Concepts

- **Shebang (`#!`)**: Indicates the interpreter to be used for the script.
- **Variables**: Used to store data. Example: `VARIABLE_NAME=value`.
- **Control Structures**: Conditional statements (`if`, `else`, `elif`), loops (`for`, `while`).
- **Functions**: Encapsulate code for reuse. Example:
  ```bash
  function_name() {
    # code
  }
  ```
- **Arrays**: Store multiple values. Example: `array_name=(value1 value2 value3)`.

### Advanced Concepts

- **Parameter Expansion**: Manipulate variable values. Example: `${variable:-default_value}`.
- **Command Substitution**: Capture the output of a command. Example: `result=$(command)`.
- **Here Documents**: Multiline strings for input redirection. Example:
  ```bash
  cat << EOF
  This is a here document.
  EOF
  ```
- **Error Handling**: Use `trap` to handle errors and signals. Example:
  ```bash
  trap 'echo "Error occurred"' ERR
  ```
- **Debugging**: Use `set -x` to enable debugging and `set +x` to disable.

## Resources

- [Bash Scripting Guide](https://tldp.org/LDP/Bash-Beginners-Guide/html/)
- [Advanced Bash-Scripting Guide](https://tldp.org/LDP/abs/html/)
- [Bash Official Documentation](https://www.gnu.org/software/bash/manual/)

## Exercises

### Easy Problem

**Task**: Write a script to display the current date and time.

**Solution**:
```bash
#!/bin/bash
# Script to display current date and time

echo "Current date and time: $(date)"
```

### Medium Problem

**Task**: Write a script to back up a directory to a specified location, logging the operations.

**Solution**:
```bash
#!/bin/bash
# Script to back up a directory

SOURCE_DIR=$1
BACKUP_DIR=$2
LOGFILE="backup.log"

if [ ! -d "$SOURCE_DIR" ]; then
  echo "Source directory does not exist."
  exit 1
fi

ARCHIVE_NAME="$(basename $SOURCE_DIR)_$(date +%Y%m%d%H%M%S).tar.gz"

tar -czf $ARCHIVE_NAME $SOURCE_DIR
mv $ARCHIVE_NAME $BACKUP_DIR
echo "$(date): Backed up $SOURCE_DIR to $BACKUP_DIR/$ARCHIVE_NAME" >> $LOGFILE
```

### Hard Problem

**Task**: Write a script to monitor a directory for changes and log the changes.

**Solution**:
```bash
#!/bin/bash
# Script to monitor a directory for changes

MONITOR_DIR=$1
LOGFILE="monitor.log"

if [ ! -d "$MONITOR_DIR" ]; then
  echo "Directory to monitor does not exist."
  exit 1
fi

inotifywait -m -e create -e modify -e delete --format '%w%f %e' $MONITOR_DIR | while read FILE EVENT; do
  echo "$(date): $EVENT $FILE" >> $LOGFILE
done
```

## Cheat Sheet

### Basic Commands

- `echo`: Print text to the terminal.
- `read`: Read input from the user.
- `date`: Display or set the system date and time.
- `tar`: Archive files.

### Control Structures

- `if` statement:
  ```bash
  if [ condition ]; then
    # code
  fi
  ```
- `for` loop:
  ```bash
  for item in list; do
    # code
  done
  ```
- `while` loop:
  ```bash
  while [ condition ]; do
    # code
  done
  ```

### Functions

- Define a function:
  ```bash
  function_name() {
    # code
  }
  ```
- Call a function:
  ```bash
  function_name
  ```

### Error Handling

- `trap` command:
  ```bash
  trap 'command' SIGNAL
  ```

### Debugging

- Enable debugging:
  ```bash
  set -x
  ```
- Disable debugging:
  ```bash
  set +x
  ```
